<!DOCTYPE html>
<!-- saved from url=(0080)http://festivalchecker.azurewebsites.net/?token=643af7276421e8741736ba4512d657f8 -->
<html class=" js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths" lang="" hola_ext_inject="disabled"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            <!--body {-->
                <!--padding-top: 50px;-->
                <!--padding-bottom: 20px;-->
            <!--}-->

            span.glyphicon-ok {
                font-size: 3.5em;
            }

            span.glyphicon-remove {
                font-size: 3.5em;
            }

            .top5 { margin-top:5px; }
            .top7 { margin-top:7px; }
            .top10 { margin-top:10px; }
            .top15 { margin-top:15px; }
            .top17 { margin-top:17px; }
            .top30 { margin-top:30px; }

            .glyphicon-refresh-animate {
            -animation: spin .7s infinite linear;
            -webkit-animation: spin2 .7s infinite linear;
            }

            @-webkit-keyframes spin2 {
            from { -webkit-transform: rotate(0deg);}
            to { -webkit-transform: rotate(360deg);}
            }

            @keyframes spin {
            from { transform: scale(1) rotate(0deg);}
            to { transform: scale(1) rotate(360deg);}
            }

        </style>
        <link rel="stylesheet" href="css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="./index_files/jquery.min.js"></script><style type="text/css"></style>
        <script src="./index_files/modernizr-2.8.3-respond-1.4.2.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/prettyPhoto.css" rel="stylesheet">
        <link href="css/main.css" rel="stylesheet">
        <link href="css/responsive.css" rel="stylesheet">
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    </head>
    <body class="homepage">

        <header id="header">
            <nav class="navbar navbar-inverse" role="banner">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
                        <a class="navbar-brand" href="index.html"><i class="fa fa-beer"></i> Welly Splosher</a></a> </div>
                    <div class="collapse navbar-collapse navbar-right">
                        <ul class="nav navbar-nav">
                            <li class="active"><a href="index.html">Lineup and Rumours</a></li>
                            <li><a href="schedule.html">Personalised Schedule</a></li>
                        </ul>
                    </div>
                </div>
                <!--/.container-->
            </nav>
            <!--/nav-->

        </header>
        <div class="color-border"> </div>
    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
      <div class="container">
        <h1>Festival Checker</h1>
        <p>Quickly find what artists you like are linked with festivals</p>
      </div>
    </div>

    <div class="container">


        <div class="row top15">

                <div hidden class="col-md-1" id="cross">
                    <span class="glyphicon glyphicon-remove" style="color:red"></span>
                </div>
                <div hidden class="col-md-1" id="tick">
                    <span class="glyphicon glyphicon-ok" style="color:green"></span>
                </div>
                <div class="col-md-2" id="lfmnamed">
                    <div id="lastfmname" class="input-group input-group-lg">
                            <p><input type="text" placeholder="Last FM ID" class="form-control" id="lastfmentry">
                            </p>
                    </div>
                </div>
                <div hidden="" class="col-md-2" id="authbutd">
                    <div id="authbut" class="input-group input-group-lg">
                        <p><button type="button" class="btn btn-default" onclick="authWithLastFm()">Authenticate</button>
                        </p>
                    </div>
                </div>

                <div hidden="" class="col-md-1" id="spinner">
                    <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
                </div>
                <div class="col-md-1" id="reccod">
                    <div id="recoo" class="input-group input-group-lg">
                        <div class="checkbox">
                            <label><input id="reccobox" type="checkbox" value="" onclick="togglerecco()">Recommended mode</label>
                        </div>
                    </div>
                </div>
        </div>
        <div class="row top15">
            <div class="col-md-1">
                <div id="historic" class="input-group input-group-lg">
                    <div class="checkbox">
                        <label><input id="histbox" type="checkbox" value="" onclick="togglehist()">Historical</label>
                    </div>
                </div>
            </div>
            <div hidden="" id="year" class="col-md-2" style="display: none;">
                <div class="input-group input-group-lg">
                    <p><input type="text" placeholder="Year" class="form-control" id="yearentry">
                    </p>
                </div>
            </div>

        </div>
        <div class="row top15">
            <div class="container">
                <div class="btn-group btn-group-lg" role="group" aria-label="Large button group">
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;glastonbury&#39;)">Glastonbury</button>
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;iow&#39;)">Isle of Wight</button>
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;latitude&#39;)">Latitude</button>
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;download&#39;)">Download</button>
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;80srewind&#39;)">80s Rewind</button>
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;bestival&#39;)">Bestival</button>
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;reading&#39;)">Reading</button>
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;vvvchelmsford&#39;)">V Chelmsford</button>
                    <button type="button" class="btn btn-default" onclick="fetchResults(&#39;vvvstafford&#39;)">V Stafford</button>
                </div>
            </div>
        </div>

      <!-- Example row of columns -->
        <div class="row">
            <table id="results" class="table table-striped">

            </table>
        </div>
        <script>
            $( document ).ready(function() {
                if((getAuthKey() != "" && getAuthKey() != null)) {
                    $("#lfmnamed").hide();  // checked
                    $("#authbutd").show();  // checked
                    $("#reccobox").prop('checked', true);
                    $("#tick").show();
                }
                else {
                    $("#lfmnamed").show();  // checked
                    $("#authbutd").hide();  // checked
                    $("#reccobox").prop('checked', false);
                }
            });

            function fetchResults(festival) {
                    $('#spinner').show();
                    var username = $('#lastfmentry').val();
                    var token = getAuthKey();
                    console.log(username);
                    if( $('#reccobox').is(':checked')) {
                        var url = 'http://glasto.cloudapp.net:80/r/' + festival + "/" + token;
                    } else {
                        var url = 'http://glasto.cloudapp.net:80/' + festival + "/" + username;
                    }
                    if($("#histbox").is(':checked')) {
                        var year = $('#yearentry').val();
                        url = url + "?year=" + year;
                    }
                    $.ajax({
                        url: url,
                        dataType: 'JSON',
                        type: 'GET',
                        success: function (json) {
                            clearTable();
                            var tr;
                            for (var i = 0; i < json.length; i++) {
                                tr = $('<tr/>');
                                tr.append("<td>" + json[i].name + "</td>");
                                tr.append("<td>" + json[i].day + "</td>");
                                tr.append("<td>" + json[i].stage + "</td>");
                                tr.append("<td>" + json[i].status + "</td>");
                                console.log(tr);
                                setTableCss(tr,json[i].status);
                                $('#results').append(tr);
                            }
                            $('#spinner').hide();
                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            $('#results').html("ERROR - That festival may not have run that year, or the LastFM account does not exist");
                            $('#spinner').hide();
                        }
                    });
            }

            function clearTable() {
                $('#results').html("<thead><tr><th>Artist</th><th>Day</th><th>Stage</th><th>Status</th></tr></thead>");
            }

            function setTableCss(tr, status) {
                switch(status) {
                    case "Confirmed":
                        tr.addClass("success");
                        break;
                    case "To Be Confirmed":
                        tr.addClass("info");
                        break;
                    case "Strong Rumour":
                        tr.addClass("warning");
                        break;
                    case "Rumour":
                        tr.addClass("danger");
                        break;
                    default:
                }
            }

            function togglerecco() {
                console.log("toggling");
                if($("#reccobox").is(':checked')) {
                    console.log("showing");
                    $("#lfmnamed").hide();  // checked
                    $("#authbutd").show();  // checked
                    if((getAuthKey() != "" && getAuthKey() != null)) {
                        $("#cross").hide();
                        $("#tick").show();
                    }
                    else {
                        $("#cross").show();
                        $("#tick").hide();
                    }
                }
                else {
                    console.log("hiding");
                    $("#lfmnamed").show();  // checked
                    $("#authbutd").hide();  // checked
                    $("#cross").hide();
                    $("#tick").hide();
                }
            }

            function togglehist() {
                if($("#histbox").is(':checked')) {
                    console.log("showing");
                    $("#year").show();  // checked
                }
                else {
                    console.log("hiding");
                    $("#year").hide();
                }
            }

            function authWithLastFm() {
                // add indicator as to whether auth key is present
                // do something a bit more clever with key returned, cookie perhaps
                window.location.replace("http://www.last.fm/api/auth?api_key=0ba3650498bb88d7328c97b461fc3636&cb=http://festivalchecker.azurewebsites.net");
            }

            function getAuthKey() {
                return window.location.search.replace("?token=", "");
            }
        </script>
        <script src="js/jquery.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/jquery.prettyPhoto.js"></script>
        <script src="js/jquery.isotope.min.js"></script>
        <script src="js/main.js"></script>


      <hr>

      <footer>
        <p>Powered by Last.FM and eFestivals.co.uk</p>
      </footer>
    </div> <!-- /container -->

    

</body></html>